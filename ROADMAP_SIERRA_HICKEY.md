# The Sierra-Hickey Roadmap for Alakey
> "We can verify nothing if we cannot separate the 'what' from the 'when' and 'where'." â€” *Adapted from Rich Hickey*

This roadmap defines the **Next Generation** of Alakey, moving beyond "Clean Architecture" to **Principles of Simple Design**.

## Phase 1: The Value of Values (Hickey)
**Goal**: Eradicate "Place-Oriented Programming" (PLOP).
*   [ ] **The Data-Registry Pattern**:
    *   *Concept*: Objects with getters/setters are "Places". Maps and Records are "Values".
    *   *Action*: Convert all remaining `data class` usage in the Domain layer to pure `Value Objects` or plain Maps where appropriate to decouple schema from code.
*   [ ] **Epochal Time Travel**:
    *   *Concept*: If state is a value, we can hold multiple states.
    *   *Action*: Implement a "Time Slider" in the Debug Drawer that allows replaying the `AppViewModel.UiState` history (using the `EventLog` as the tape).

## Phase 2: Functional Core, Imperative Shell (Bernhardt/Sierra)
**Goal**: Push all Side-Effects (Database, Network, Audio) to the absolute boundaries.
*   [ ] **The Pure Logic Audit**:
    *   *Concept*: Logic inside `UniversalRepository` (even if delegated) is still mixed with IO scheduling.
    *   *Action*: Ensure `UniversalRepository` becomes strictly an *Interpreter* of commands generated by `PureLogic`.
    *   *Metric*: 90% of the app's code should run in a unit test with NO mocks.
*   [ ] **Declarative Drivers**:
    *   *Action*: The `PlaybackClient` should not "call" ExoPlayer. It should Emit a `PlaybackSpec`. A separate "Driver" observes this Spec and reconciles the Player (React-style).

## Phase 3: Component System (Sierra)
**Goal**: Systems should be fundamentally reloadable and stoppable.
*   [ ] **Structured Lifecycle**:
    *   *Concept*: `AudioService` is currently a monolithic Android Service.
    *   *Action*: Decompose into `System` components (`DatabaseComponent`, `NetworkComponent`, `AudioComponent`) that can be started/stopped independently for testing.
*   [ ] **REPL-Driven State**:
    *   *Action*: Expose a Telnet/Socket REPL (or ADB Interface) to inject facts directly into the `EventLog`, bypassing the UI.

## Phase 4: Simplicity (Hickey)
**Goal**: Untangle "What it does" from "How it runs".
*   [ ] **De-complecting Navigation**:
    *   *Action*: Navigation is currently coupled to Jetpack Compose `NavController`. Move to a pure `Stack<ScreenSpec>` in the ViewModel. The View merely renders the top of the stack.
*   [ ] **Library Diet**:
    *   *Action*: Audit dependencies. If a library complects us (ties us to a specific framework version unnecessarily), remove it or wrap it behind a pure protocol.

## Phase 5: Information Model (Datomic Inspiration)
**Goal**: Facts, not Tables.
*   [ ] **Universal Fact Schema**:
    *   *Concept*: Move beyond strict SQL tables for non-critical attributes.
    *   *Action*: Introduce an `Attributes` table (`entity_id`, `attribute`, `value`, `timestamp`) for flexible feature flagging and user preferences without migration.

## Phase 6: The Logical Frontend (David Nolen)
**Goal**: The Future of MVC.
*   [ ] **Interceptor Chain (OM Next/Re-frame style)**:
    *   *Concept*: Controllers are dead. Logic is handled by a chain of pure functions (Interceptors) that transform the `Coeffect` (World State) into `Effects`.
    *   *Action*: Replace `ViewModel` methods with a single `dispatch(Event)` system where events pass through an Interceptor Chain (Log -> Validate -> Mutate -> Effect).
*   [ ] **Optimistic UI with Rollback**:
    *   *Concept*: Because state is a value, we can "guess" the next state (Optimistic Update) and trivially "reset" (Time Travel) if the network fails, without complex undo logic.

## Phase 7: System Observability (Stuart Halloway)
**Goal**: If you can't query it, you can't debug it.
*   [ ] **Queryable Log**:
    *   *Concept*: Logs are just data.
    *   *Action*: Store application logs in an in-memory SQL table (or SQLite buffer). Allow developers to query logs via SQL (`SELECT * FROM logs WHERE severity > 'WARN'`) at runtime.
*   [ ] **REPL as First-Class Citizen**:
    *   *Action*: Embed a tiny HTTP server in the Debug build that accepts EDN/JSON commands to inspect the `UniversalRepository` state live from a laptop terminal.
